<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ø£Ø¯Ø§Ø© Ø§Ù„ØªÙ†Ø¨Ø¤ Ø¨Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø´Ù…Ø¹Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø© - Binance</title>
  <style>
    body {
      font-family: Tahoma, sans-serif;
      direction: rtl;
      background-color: #f5f5f5;
      padding: 20px;
    }
    .tool-container {
      max-width: 500px;
      margin: auto;
      background: #fff;
      padding: 20px;
      border-radius: 16px;
      box-shadow: 0 0 15px rgba(0,0,0,0.1);
    }
    select, button {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      font-size: 16px;
      border-radius: 10px;
      border: 1px solid #ccc;
    }
    button {
      background-color: #3b82f6;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #2563eb;
    }
    .result {
      margin-top: 20px;
      background: #f0f9ff;
      padding: 15px;
      border-radius: 10px;
      border: 1px solid #d1eaff;
    }
    .loading {
      text-align: center;
      margin-top: 15px;
    }
  </style>
</head>
<body>
  <div class="tool-container">
    <h2>ğŸ” Ø£Ø¯Ø§Ø© ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø´Ù…Ø¹Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø© - Binance</h2>

    <label for="pair">Ø§Ø®ØªØ± Ø²ÙˆØ¬ Ø§Ù„Ø¹Ù…Ù„Ø©:</label>
    <select id="pair">
      <option value="btcusdt">BTC/USDT</option>
      <option value="ethusdt">ETH/USDT</option>
      <option value="bnbusdt">BNB/USDT</option>
      <option value="solusdt">SOL/USDT</option>
      <option value="xrpusdt">XRP/USDT</option>
      <option value="dogeusdt">DOGE/USDT</option>
      <option value="adausdt">ADA/USDT</option>
      <option value="trxusdt">TRX/USDT</option>
    </select>

    <button onclick="analyzeCandle()">ğŸ” ØªØ­Ù„ÙŠÙ„</button>

    <div class="loading" id="loading">ğŸ“¡ Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­ÙŠØ©...</div>
    <div class="result" id="result" style="display:none;"></div>
  </div>

  <script>
    let socket;
    let latestCandle;

    function connectWebSocket(pair) {
      if (socket) socket.close();
      const url = `wss://stream.binance.com:9443/ws/${pair}@kline_5m`;
      socket = new WebSocket(url);
      socket.onmessage = function (event) {
        const data = JSON.parse(event.data);
        if (data.k && !data.k.x) {
          latestCandle = data.k; // Ø§Ù„Ø´Ù…Ø¹Ø© Ù‚ÙŠØ¯ Ø§Ù„ØªÙƒÙˆÙŠÙ†
        }
      };
    }

    function analyzeCandle() {
      const resultBox = document.getElementById("result");
      resultBox.style.display = "block";
      if (!latestCandle) {
        resultBox.innerHTML = "âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø­ÙŠØ© Ø­Ø§Ù„ÙŠØ§Ù‹. Ø§Ù†ØªØ¸Ø± Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ø«Ù… Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.";
        return;
      }

      const open = parseFloat(latestCandle.o);
      const close = parseFloat(latestCandle.c);
      const high = parseFloat(latestCandle.h);
      const low = parseFloat(latestCandle.l);
      const volume = parseFloat(latestCandle.v);

      let direction = "Ø´Ø±Ø§Ø¡";
      let confidence = 50;
      let reason = "";

      const body = Math.abs(close - open);
      const candleSize = high - low;
      const upperWick = high - Math.max(open, close);
      const lowerWick = Math.min(open, close) - low;

      if (close < open) {
        direction = "Ø¨ÙŠØ¹";
      }

      if (body / candleSize > 0.6) {
        confidence = 85;
        reason = "Ø¬Ø³Ù… Ø´Ù…Ø¹Ø© ÙƒØ¨ÙŠØ± ÙˆØ§ØªØ¬Ø§Ù‡ ÙˆØ§Ø¶Ø­ ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚ Ù…Ø¹ Ø²Ø®Ù… Ù…Ø±ØªÙØ¹.";
      } else if (body / candleSize > 0.3) {
        confidence = 70;
        reason = "Ø´Ù…Ø¹Ø© Ø¨Ø§ØªØ¬Ø§Ù‡ Ù…ØªÙˆØ³Ø· Ù…Ø¹ Ø§Ø­ØªÙ…Ø§Ù„ Ø§Ø³ØªÙ…Ø±Ø§Ø± Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø­Ø§Ù„ÙŠ.";
      } else {
        confidence = 55;
        reason = "Ø´Ù…Ø¹Ø© ØªØ°Ø¨Ø°Ø¨ Ù…Ø¹ ÙØªØ§Ø¦Ù„ Ø·ÙˆÙŠÙ„Ø© Ù‚Ø¯ ØªØ´ÙŠØ± Ù„ØªØºÙŠØ± ÙÙŠ Ø§Ù„Ø§ØªØ¬Ø§Ù‡.";
      }

      resultBox.innerHTML = `
        <strong>ğŸ”® Ø§Ù„Ø´Ù…Ø¹Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©:</strong> ${direction}<br>
        <strong>ğŸ“Š Ù†Ø³Ø¨Ø© Ø§Ù„Ø«Ù‚Ø©:</strong> ${confidence}%<br>
        <strong>ğŸ“Œ Ø§Ù„Ø³Ø¨Ø¨:</strong> ${reason}
      `;
    }

    const pairSelector = document.getElementById("pair");
    pairSelector.addEventListener("change", function () {
      document.getElementById("loading").style.display = "block";
      latestCandle = null;
      connectWebSocket(this.value);
      setTimeout(() => {
        document.getElementById("loading").style.display = "none";
      }, 3000);
    });

    // Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ø£ÙˆÙ„ÙŠ
    connectWebSocket(pairSelector.value);
    setTimeout(() => {
      document.getElementById("loading").style.display = "none";
    }, 3000);
  </script>
</body>
</html>
